<!-- app/templates/layouts/_console_base.html -->
{% extends 'layouts/_app_base.html' %}

{% block page_css %}
    <link rel="stylesheet" href="{{ url_for('static', path='css/dashboard_declarations.css') }}">

    <link rel="stylesheet" href="{{ url_for('static', path='css/dashboard_supervisor.css') }}">
<style>
    /* --- ESTRUCTURA Y MENÚS --- */
    .console-container { display: flex; flex-direction: column; min-height: calc(100vh - 10rem); }
    .console-content { flex-grow: 1; padding: 1.5rem; background-color: #1f2937; border-radius: 0.75rem; }
    .console-menu { position: fixed; bottom: 0; left: 0; right: 0; background-color: #111827; border-top: 1px solid #374151; padding: 0.75rem 1rem; display: flex; justify-content: center; gap: 0.75rem; z-index: 90; }
    .menu-btn { background-color: #4b5563; color: white; padding: 0.5rem 1.5rem; border-radius: 0.5rem; font-weight: 600; border: none; cursor: pointer; transition: all 0.2s; }
    .menu-btn.active { background-color: #0ea5e9; color: white; font-weight: 700; box-shadow: 0 0 15px rgba(14, 165, 233, 0.4); }
    .console-title-active { color: #0ea5e9; font-weight: 700; }
    
    /* --- ESTILOS DE TARJETAS (UNIFICADOS Y CORREGIDOS) --- */
    .task-card-container { display: flex; flex-direction: column; gap: 1.5rem; }
    .task-card { background-color: #2d3748; border-radius: 0.75rem; padding: 1.25rem; border: 1px solid #374151; display: flex; flex-direction: column; gap: 0.75rem; }
    .task-card-row { display: flex; align-items: center; justify-content: space-between; }
    
    /* Fila 1: Info Cliente */
    .client-info { display: flex; align-items: baseline; gap: 0.75rem; }
    .ruc-text { font-size: 0.9rem; color: #9ca3af; font-weight: 500; }
    .business-name { font-size: 1.1rem; font-weight: 600; color: white; font-family: 'Poppins', sans-serif; }
    
    /* Fila 2: Detalles (Grid de 2 Filas) */
    .task-card-details-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 0.25rem 1rem;
        padding: 0.75rem 0;
        border-top: 1px solid #374151;
        border-bottom: 1px solid #374151;
    }
    .detail-header { font-weight: 600; color: #6b7280; font-size: 0.7rem; text-align: left; text-transform: uppercase; }
    .detail-value { font-size: 0.9rem; color: #d1d5db; text-align: left; }

    /* Fila 3: Radio Buttons */
    .status-radio-group { width: 100%; display: flex; flex-wrap: wrap; gap: 0.5rem; padding: 0.75rem 0; border-bottom: 1px solid #374151; }
    .status-radio-group label { display: inline-block; }
    .status-radio-group input[type="radio"] { display: none; }
    .status-radio-group span { display: inline-block; padding: 0.3rem 0.7rem; /* Padding reducido */ background-color: #4b5563; color: #d1d5db; border-radius: 0.375rem; font-size: 0.8rem; font-weight: 600; cursor: pointer; transition: all 0.2s; }
    .status-radio-group input[type="radio"]:checked + span { background-color: #0ea5e9; color: white; }

    /* Fila 4: Acciones */
    .task-card-actions { padding-top: 0.75rem; }
    .status-and-update { display: flex; align-items: center; gap: 1rem; }
    
    /* --- COMPONENTES (UNIFICADOS) --- */
    .btn-action { background-color: #4b5563; color: white; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 600; border: none; cursor: pointer; transition: all 0.2s; }
    .btn-action.primary { background-color: #4f46e5; }
    .btn-validate { background-color: transparent; border: 2px solid #eab308; color: #eab308; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 700; cursor: pointer; transition: all 0.2s; }
    .btn-validate:hover { background-color: rgba(234, 179, 8, 0.1); }
    .sol-button-container > button.btn-action[disabled] { background-color: #374151; cursor: not-allowed; opacity: 0.8; color: #9ca3af; }
    
    /* --- Insignias y Notificaciones --- */
    .status-badge { display: inline-block; padding: 0.2rem 0.6rem; border-radius: 999px; font-size: 0.75rem; font-weight: 600; }
    .status-badge-assigned { background-color: #d97706; color: #fef3c7; }
    .status-badge-in-progress { background-color: #2563eb; color: #dbeafe; }
    .status-badge-pending-client { background-color: #9333ea; color: #f3e8ff; }
    .status-badge-failed { background-color: #be123c; color: #ffe4e6; }
    .toast-success { background-color: #10B981; color: white; padding: 1rem 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 15px rgba(0,0,0,0.2); margin-bottom: 0.5rem; opacity: 1; transition: opacity 0.5s ease-in-out; font-weight: 600; }

    /* Padding reducido para los botones de estado */
    .status-radio-group span {
        padding: 0.3rem 0.6rem;
        font-size: 0.75rem;
    }

    /* El botón "Actualizar" ahora está en su propia fila */
    .task-card-actions {
        border-top: 1px solid #374151;
        padding-top: 0.75rem;
    }
</style>
{% endblock %}

{% block main_content %}
<div class="container mx-auto px-4 pb-24">
    <div class="console-container">
        <h2 class="text-2xl font-bold text-white mb-4">{% block console_title %}Consola{% endblock %}</h2>
        <section id="console-content-area" 
                 class="console-content"
                 hx-get="{{ initial_load_url }}" 
                 hx-trigger="load">
            <div class="htmx-indicator w-full text-center p-8 text-gray-400">Cargando...</div>
        </section>
    </div>
    <nav class="console-menu" hx-target="#console-content-area" hx-swap="innerHTML">
        {% block console_menu %}{% endblock %}
    </nav>
    <div id="modal-container"></div>
    <div id="toast-container" style="position: fixed; top: 5rem; right: 1rem; z-index: 100;"></div>
</div>
{% endblock %}

{% block body_end_scripts %}
    {% include 'partials/_console_scripts.html' %}
{% endblock %}